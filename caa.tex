\documentclass[xcolor=x11names, aspectratio=169,usenames,dvipsnames]{beamer}
\usepackage[british]{babel}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{mathpazo}
\usepackage{enumerate}
\usepackage{array,booktabs}
\usepackage{tikz}
\usepackage{mathdots}
\usepackage{verbatim}
\usepackage{multirow}
\usepackage{tabularx}
\usetikzlibrary{overlay-beamer-styles,shadows,matrix,backgrounds,patterns,arrows,decorations.markings,shapes,positioning,calc,chains,scopes,fit}
\usepackage{caption}

\usetheme[titleformat title=regular,titleformat frame=regular,titleformat section=allcaps,numbering=fraction]{metropolis}

\author[Felix Kußmaul]{\large Felix Kußmaul\inst{1}}
\title[FMSync]{\Large FMSync}
\subtitle{\normalsize An Open Source Solution for Synchronising Distributed Archaeological Databases in a Centralised Open Access System}
\institute[Cologne]{\inst{1} Archäologisches Institut, Universität zu Köln}
\date[\today]{\vspace*{1em}CAA 2018, Tübingen\\[.5em] 21 March 2018\vspace*{1em}}

%\titlegraphic{
%    \tikz[overlay,remember picture]
%        \node[xshift=-5em,yshift=3em,at=(current page.south east), anchor=south east] {
%            \includegraphics[width=0.25\textwidth]{img/archaide.eps}
%        };
%}
\input{config.tex}
\definecolor{morange}{HTML}{FF8200}
\metroset{block=fill}

\setbeamercolor{background canvas}{bg=white}
 
\begin{document}

\begin{frame}[plain]
\titlepage
\end{frame}

\section{Motivation}

\begin{frame}{Before FMSync: Sharing Data}
\begin{figure}
	\begin{tikzpicture}
\only<1-4>{\draw[thick, dashed] (5.75,-3) -- (5.75,3);}
\only<5->{\draw[thick, dashed] (5.75,-4.7) -- (5.75,2);}
\node (pc) at (0,0) {\reflectbox{\includegraphics[width=2cm]{img/pc.jpg}}};
\node[right of=pc, node distance=3em] (db) {\includegraphics[width=2em]{img/db}};
\only<2->{
	\node[right of=pc, node distance=4cm](usb) {\includegraphics[width=3em]{img/usb}};
	\node[below right of=usb, node distance=1em] (db2) {\includegraphics[width=1em]{img/db}};
	\draw[arrows=-latex,ultra thick] (db) -- node [above] {\small{copy}} (usb);
}
\only<3->{
	\node[right of=usb, node distance=3.5cm](usb2) {\includegraphics[width=3em]{img/usb}};
	\node[below right of=usb2, node distance=1em] (db4) {\includegraphics[width=1em]{img/db}};
	\draw[arrows=-latex,ultra thick] (usb) -- node[above] (box) {\includegraphics[width=4em]{img/box}} (usb2);
}
\node[right of=pc, node distance=11.5cm] (pc2) {\includegraphics[width=2cm]{img/pc.jpg}};
\node[left of=pc2, node distance=3em] (db3) {\includegraphics[width=2em]{img/db2}};
\only<4->{
	\node[below left of=db3, node distance=1em] (dbb3) {\includegraphics[width=2em]{img/db}};
	\draw[arrows=-latex,ultra thick] (usb2) -- node [above] {\small{copy}} (dbb3);
}
\only<5->{
	\node (pcb) at (0,-3.3) {\reflectbox{\includegraphics[width=2cm]{img/pc.jpg}}};
	\node[right of=pcb, node distance=3em] (dbb) {\includegraphics[width=2em]{img/db}};
	\node[below right of=dbb, node distance=1em] (dbb3b) {\includegraphics[width=2em]{img/db2}};
	\node[right of=pcb, node distance=4cm](usbb) {\includegraphics[width=3em]{img/usb}};
	\node[below right of=usbb, node distance=1em] (db2b) {\includegraphics[width=1em]{img/db2}};
	\draw[arrows=-latex,ultra thick] (usbb) -- node [above] {\small{copy}} (dbb3b);
	\node[right of=usbb, node distance=3.5cm](usb2b) {\includegraphics[width=3em]{img/usb}};
	\node[below right of=usb2b, node distance=1em] (db4b) {\includegraphics[width=1em]{img/db2}};
	\draw[arrows=-latex,ultra thick] (usb2b) -- node[above] (boxb) {\includegraphics[width=4em]{img/box}} (usbb);
	\node[right of=pcb, node distance=11.5cm] (pc2b) {\includegraphics[width=2cm]{img/pc.jpg}};
	\node[left of=pc2b, node distance=3em] (db3b) {\includegraphics[width=2em]{img/db2}};
	\node[below left of=db3b, node distance=1em] {\includegraphics[width=2em]{img/db}};
	\draw[arrows=-latex,ultra thick] (db3b) -- node [above] {\small{copy}} (usb2b);
}
\end{tikzpicture}
\end{figure}
\end{frame}

\begin{frame}{Before FMSync: Publishing Data}
\begin{figure}
	\begin{tikzpicture}
	\draw[thick, dashed] (5.75,-3) -- (5.75,3);
	\node (pc) at (0,0) {\reflectbox{\includegraphics[width=2cm]{img/pc.jpg}}};
	\node[right of=pc, node distance=3em] (db) {\includegraphics[width=2em]{img/db}};
	
		\node[right of=pc, node distance=4cm](usb) {\includegraphics[width=3em]{img/usb}};
		\node[below right of=usb, node distance=1em] (db2) {\includegraphics[width=1em]{img/db}};
		\draw[arrows=-latex,ultra thick] (db) -- node [above] {\small{copy}} (usb);
		
		\node[right of=usb, node distance=3.5cm](usb2) {\includegraphics[width=3em]{img/usb}};
		\node[below right of=usb2, node distance=1em] (db4) {\includegraphics[width=1em]{img/db}};
		\draw[arrows=-latex,ultra thick] (usb) -- node[above] (box) {\includegraphics[width=4em]{img/box}} (usb2);
		
	\node[right of=pc, node distance=11.5cm] (pc2) {\includegraphics[width=3cm]{img/serv.pdf}};
	\draw[arrows=-latex,ultra thick] (usb2) -- (pc2);
	\only<2->{
		\node at (pc2) {\includegraphics[height=.7\textheight]{img/no-fucks-given.jpg}};
	}
	\end{tikzpicture}
\end{figure}
\end{frame}

\section{Approach}

\begin{frame}{FMSync: Topology}
\begin{figure}
	\includegraphics[height=.8\textheight]{img/topo.pdf}
\end{figure}
\end{frame}

\begin{frame}{Wait a sec \dots!}\large
Yo, Felix! 'Tis nuthin nu.\pause\bigskip
\normalsize

\begin{quote}
	\textbf{SymmetricDS} supports [\dots] \alert{Oracle}, \alert{MySQL}, MariaDB, \alert{PostgreSQL}, MS SQL Server (including Azure), IBM DB2 (UDB, iSeries, and zSeries), H2, HSQLDB, Derby, Firebird, Interbase, Informix, Greenplum, \alert{SQLite}, Sybase ASE, Sybase ASA (SQL Anywhere), Amazon Redshift, \alert{MongoDB}, and VoltDB databases.
\end{quote}\vspace{-1em}
\begin{flushright}
	\texttt{https://www.symmetricds.org/}
\end{flushright}
\end{frame}

\begin{frame}{FileMaker Solution}
\begin{figure}
\includegraphics[width=\linewidth]{img/order.png}
\end{figure}\vspace{-2em}
\begin{itemize}
\item Proprietary, badly written software
\item Still totally not worth the price
\end{itemize}
\end{frame}

\begin{frame}{Our Solution}
open source (license!), free, platform independent (java)
\end{frame}

\begin{frame}{Why underestimation is bad}
\begin{center}
\begin{figure}
	\includegraphics[width=\textwidth]{img/xkcd.png}
	\caption{I can relate to this. [xkcd.com/1831]}
\end{figure}
\end{center}
\end{frame}

\section{Implementation}

\begin{frame}{Foreign Key Difficulty}\ttfamily\footnotesize
\begin{figure}
	\begin{tikzpicture}[/tikz/ampersand replacement=\&, label distance=.5cm,  every node/.style = {anchor= north west},every label/.style={font=\normalsize\sffamily\bfseries},
		table/.style={matrix of nodes, nodes in empty cells, column sep=-\pgflinewidth, row sep=-\pgflinewidth, nodes={draw,text depth=.5ex,text height=2ex,minimum width=2.5em}, row 1/.style={font=\bfseries, nodes={fill=lightgray!50,minimum height=1.7em}}}]
		
		\matrix(tl) [table, label=left:Type] {
			ID \& \dots \& FK\_Fabric \& \dots\only<1,3->{\\
			14 \& \dots \& \phantom{FKhl}3\phantom{abri} \& \dots}\only<2>{\\
			14 \& \dots \&|[fill=Green!40]| \phantom{FKhl}3\phantom{abri} \& \dots} \\};
		
		\matrix(fl) [table, label=left:Fabric, below=2.5cm of tl.south west,right] {
			ID \& color\&\dots\only<1,3->{\\
			3 \& brown\&\dots}
			\only<2>{\\
			|[fill=Green!40]| 3 \& brown\&\dots}\\};
	
	\visible<2>{\draw[ultra thick,->,color=OliveGreen] (tl-2-3.south)-- (fl-2-1.north);}	
	
	\visible<3->{
		\draw[thick, dashed] (5.75,-5.5) -- (5.75,0.5);
		\matrix(tr) [table, right=7cm of tl.north west, anchor=north west] {
			ID \& \dots \& FK\_Fabric \& \dots \\
			105 \& \dots \& \phantom{FKhl}x\phantom{abri} \& \dots\only<5,6>{\\
			106 \& \dots \& \phantom{FKhl}3\phantom{abri} \& \dots}\only<4>{\\
			|[fill=Green!40]| 106 \& \dots \& \phantom{FKhl}3\phantom{abri} \& \dots}\only<7->{\\
			106 \& \dots \&|[fill=red!40]|  \phantom{FKhl}3\phantom{abri} \& \dots} \\};
		
		\matrix(fr) [table, right=7cm of fl.north west, anchor=north west] {
			ID \& color\&\dots \\
			81 \& red\phantom{xt}\&\dots\only<6>{\\
			82 \& brown\&\dots}\only<5>{\\
			|[fill=Green!40]| 82 \& brown\&\dots}\only<7->{\\
			|[fill=red!40]| 82 \& brown\&\dots} \\};
	}
	\only<4>{\draw[ultra thick,->,color=OliveGreen] (tl-2-4.east)-- node[above]{import} (tr-3-1.west);}
	\only<5>{\draw[ultra thick,->,color=OliveGreen] (fl-2-3.east)-- node[above]{import} (fr-3-1.west);}
	\only<8>{\draw[ultra thick,->,color=red] (tr-3-3.north)--(7.75,0)node[above left]{\dots} ;}
	\end{tikzpicture}
\end{figure}
\end{frame}

\begin{frame}[plain,standout]
\vfill\vfill\vfill
\begin{center}\Large
Thank you very much for your attention!\\\bigskip

Questions?
\end{center}\vfill\vfill
\end{frame}

\maketitle

\end{document}
